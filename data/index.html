<!DOCTYPE html>
<html>
<head>
  <title>IMU GrafiÄŸi</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h2>Roll / Pitch / Yaw</h2>
  <canvas id="imuChart" width="600" height="300"></canvas>

  <script>
    const ctx = document.getElementById('imuChart').getContext('2d');
    const chart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [],
        datasets: [
          { label: 'Roll', data: [], borderColor: 'red' },
          { label: 'Pitch', data: [], borderColor: 'green' },
          { label: 'Yaw', data: [], borderColor: 'blue' }
        ]
      },
      options: {
        animation: false,
        scales: {
          x: { display: false },
          y: { min: -180, max: 180 }
        }
      }
    });

    let t = 0;
    setInterval(() => {
      fetch('/data')
        .then(res => res.json())
        .then(data => {
          chart.data.labels.push(t++);
          chart.data.datasets[0].data.push(data.roll);
          chart.data.datasets[1].data.push(data.pitch);
          chart.data.datasets[2].data.push(data.yaw);

          if (chart.data.labels.length > 100) {
            chart.data.labels.shift();
            chart.data.datasets.forEach(ds => ds.data.shift());
          }

          chart.update();
        });
    }, 100);
  </script>
</body>
</html>
